<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <!-- Required meta tags -->
  <!--    <meta http-equiv="refresh"-->
  <!--          content="0; URL='list'">-->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
        crossorigin="anonymous">
  <title>Stocks Directory</title>
</head>

<body>
<div class="container">
  <div class = "navbar navbar-expand-lg navbar-dark bg-dark static-tops">
    <div>
      <nav class = "navbar navbar-expand-sm bg-dark navbar-dark">
        <ul class = "navbar-nav">
          <li class="nav-item">
            <a class="nav-link fas fa-home fa-2x icon-silver" th:href="@{/dashboard/list}"> Home </a>
          </li>
        </ul>
        <ul class = "navbar-nav">
          <form class="nav-item" th:action ="@{/dashboard/list}">
            <input type="text" placeholder="Search" name="keyword" th:value="${keyword}"/>
            <input type="submit" class="btn btn-primary btn-sm mb-1" value="Search"/>
          </form>
        </ul>
        <ul class = "navbar-nav">
          <li class="nav-item">
            <a class="nav-link fas fa-home float-right"
               th:href="@{/accounts/list}"> Accounts </a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <h1>Stock Information</h1>
  <hr>
  <table class="table table-bordered table-striped">
    <thead class="table-dark">
    <tr>
      <th>Name</th>
      <th>Symbol</th>
      <th>Sector</th>
      <th>Action(s)</th>
    </tr>
    </thead>

    <tbody>
    <tr>
      <td th:text="${stock.name}" />
      <td th:text="${stock.symbol}" />
      <td th:text="${stock.sector}" />
      <td>
        <a href="#bottom"
           class="btn btn-primary btn-sm mb-1"> Buy / Sell </a>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<div id="container" style="width: 800px; height: 600px; margin: 0 auto; align: center"></div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>

<script th:inline="javascript">
    $(function(){
    Highcharts.chart('container', {
        chart: {
            type: 'area',
            zoomType: 'x',
            panning: true,
            panKey: 'shift'
        },
        title: {
            text: 'Stock Chart',
            align: 'left'
        },
        xAxis: {
            categories: [[${surveyMap.keySet()}]],
            crosshair: true,
            minRange: 5,
            maxRange: 15,
            title: {
                text: 'Time'
            }
        },
        yAxis: {
            min: 0,
            max:600,
            minRange: 5,
            maxRange: 15,
            title: {
                text: 'Stock Price'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
            '<td style="padding:0"><b>{point.y:.1f} K</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        legend: {
            enabled: false
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            data: [[${surveyMap.values()}]],
            marker: {
                enabled: false
            }
<!--            lineColor: blue,-->
<!--            color: green-->
<!--            fillOpacity: 0.5-->
<!--            threshold: null-->
        }]
    });
    });
</script>
</div>

<table class="table table-hover">
  <tbody>
    <tr>
      <td>
        <form th:action="@{/stocks/buy}" method="post">
          <input type="hidden" name="id" th:field="${stock.id}" />
          <input type="number" name="buy_quantity" placeholder="Enter the no. of stocks to buy"
                 class="form-control mb-4 w-50" required>
          <button type="submit" class="btn btn-info col-2"> Buy </button>
        </form>
      </td>
      <td>
        <form th:action="@{/stocks/sell}" method="post">
          <input type="hidden" name="id" th:field="${stock.id}" />
          <input type="number" name="sell_quantity" placeholder="Enter the no. of stocks to sell"
                 class="form-control mb-4 w-50" required>
          <button type="submit" class="btn btn-info col-2"> Buy </button>
        </form>
      </td>
    </tr>

  </tbody>
</table>


<div id="bottom"></div>
</body>
</html>

